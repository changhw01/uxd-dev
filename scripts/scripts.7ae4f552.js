var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){var b,c,d,e,f,g,h,i="",j=0;for(a=Base64._utf8_encode(a);j<a.length;)b=a.charCodeAt(j++),c=a.charCodeAt(j++),d=a.charCodeAt(j++),e=b>>2,f=(3&b)<<4|c>>4,g=(15&c)<<2|d>>6,h=63&d,isNaN(c)?g=h=64:isNaN(d)&&(h=64),i=i+this._keyStr.charAt(e)+this._keyStr.charAt(f)+this._keyStr.charAt(g)+this._keyStr.charAt(h);return i},decode:function(a){var b,c,d,e,f,g,h,i="",j=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");j<a.length;)e=this._keyStr.indexOf(a.charAt(j++)),f=this._keyStr.indexOf(a.charAt(j++)),g=this._keyStr.indexOf(a.charAt(j++)),h=this._keyStr.indexOf(a.charAt(j++)),b=e<<2|f>>4,c=(15&f)<<4|g>>2,d=(3&g)<<6|h,i+=String.fromCharCode(b),64!=g&&(i+=String.fromCharCode(c)),64!=h&&(i+=String.fromCharCode(d));return i=Base64._utf8_decode(i)},_utf8_encode:function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):d>127&&2048>d?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b},_utf8_decode:function(a){for(var b="",c=0,d=c1=c2=0;c<a.length;)d=a.charCodeAt(c),128>d?(b+=String.fromCharCode(d),c++):d>191&&224>d?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&c2),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((15&d)<<12|(63&c2)<<6|63&c3),c+=3);return b}},dependencyModules=["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","firebase","firebase.utils"],myAppComponents=["FerryBuildingApp.Members","FerryBuildingApp.Projects","FerryBuildingApp.Questions","FerryBuildingApp.About","FerryBuildingApp.Secrets"];angular.module("FerryBuildingApp",dependencyModules.concat(myAppComponents)).factory("Auth",["$firebaseAuth",function(a){var b=new Firebase("https://taiwanuxd-dev.firebaseio.com/");return a(b)}]).run(["$rootScope","$location",function(a,b){a.$on("$routeChangeError",function(a,c,d,e){"AUTH_REQUIRED"===e&&b.path("/login")})}]).controller("loginCtrl",["$scope","Auth",function(a,b){a.auth=b,a.user=a.auth.$getAuth(),a.loginfacebook=function(){a.auth.$authWithOAuthPopup("facebook").then(function(){a.user=a.auth.$getAuth()})["catch"](function(){console.error("Authetication failed")})},a.logout=function(){a.auth.$unauth(),a.user=a.auth.$getAuth()}}]);var __static_json_data="/stats.data",__json_data={};$.get(__static_json_data).done(function(a){__json_data=jQuery.parseJSON(Base64.decode(a))}),angular.module("FerryBuildingApp").controller("MainCtrl",["$scope","$timeout","$firebase",function(a,b){var c=new Firebase("taiwanuxd-dev.firebaseio.com/group");c.once("value",function(c){b(function(){a.groups=c.val()})})}]);var app=angular.module("FerryBuildingApp.Members",[]).controller("MembersCtrl",["$scope","$timeout","$firebase","curAuth",function(a,b){var c=new Firebase("taiwanuxd-dev.firebaseio.com/people");c.once("value",function(c){b(function(){a.members=c.val()})})}]);app.directive("imageonload",function(){return{restrict:"A",link:function(a,b){b.bind("load",function(){alert("image is loaded")})}}});var app=angular.module("FerryBuildingApp.Projects",[]).controller("ProjectsCtrl",["$scope","$timeout","$firebase","curAuth",function(a,b){var c=new Firebase("taiwanuxd-dev.firebaseio.com/projects");c.once("value",function(c){b(function(){a.projects=c.val(),a.getPic=function(a,b){return a&&(a=a.replace("facebook:","")),"https://graph.facebook.com/"+(a||this._uid.replace("facebook:",""))+"/picture/?type="+(b?"large":"square")+"&return_ssl_resources=1"}})})}]);app.directive("imageonload",function(){return{restrict:"A",link:function(a,b){b.bind("load",function(){alert("image is loaded")})}}}),angular.module("FerryBuildingApp.Questions",[]).controller("QuestionsCtrl",["$scope","$timeout","$firebase","curAuth",function(a,b,c,d){a.user={uid:d.uid,displayName:d.facebook.displayName,answers:{}};var e=new Firebase("https://taiwanuxd-dev.firebaseio.com/questions"),f=c(e);a.questions=f.$asArray(),a.updateAnsInQuestion=function(b,c){a.questions[b].answers[a.user.uid]=c}}]);var all_groups=null,root_gid="grp:1420176858663",root_group={},app=angular.module("FerryBuildingApp.About",[]).controller("AboutCtrl",["$scope","$timeout","$firebase","$location",function(a,b){var c=new Firebase("taiwanuxd-dev.firebaseio.com/groups");c.once("value",function(c){b(function(){a.groups=c.val(),all_groups=c.val(),root_group=all_groups[root_gid]})}),a.setGroup=function(a){b(function(){root_gid=a,root_group=all_groups[root_gid],$("#enterGroupModal").modal("toggle")})},a.getCurrentGroupID=function(){return root_group.gid},a.getCurrentGroupTitle=function(){return root_group.title},a.getCurrentGroupDescription=function(){return root_group.description},a.getCurrentGroupLongDescription=function(){return root_group.long_description},a.signin=function(a){console.log("sign in to "+a)},a.go=function(){}}]);app.directive("modalShow",["$parse",function(a){return{restrict:"A",link:function(b,c,d){b.showModal=function(a,b){b||(b=c),$(b).modal(a?"show":"hide")},b.$watch(d.modalShow,function(a){b.showModal(a,d.$$element)}),$(c).bind("hide.bs.modal",function(){a(d.modalShow).assign(b,!1),b.$$phase||b.$root.$$phase||b.$apply()})}}}]),angular.module("FerryBuildingApp.Secrets",[]).controller("SecretsCtrl",["$scope","curAuth",function(a){var b=[],c=[],d=0,e=0;for(var f in __json_data.question_stats)__json_data.question_stats[f].Gender.isSecret&&(e+=1,__json_data.question_stats[f].Gender.type="Gender Difference",b.push(__json_data.question_stats[f])),__json_data.question_stats[f].Professions.isSecret&&(d+=1,__json_data.question_stats[f].Professions.type="Profession Difference",c.push(__json_data.question_stats[f]));c3.generate({bindto:"#chart_secret_type",color:{pattern:["#1ABC9C","#00BCD4","#CFD8DC"]},size:{width:200,height:200},legend:{show:!1},data:{columns:[["Gender secret",e],["Profession secret",d],["No secrets (yet)",__json_data.total_public_questions-b.length-c.length]],type:"donut",onclick:function(d){0==d.index?(console.log("display "+d.name),a.renderSecretChart(b,[])):1==d.index?(console.log("display "+d.name),a.renderSecretChart([],c)):(console.log("hide all"),a.renderSecretChart([],[]))},order:"desc"},donut:{width:40}});a.renderSecretChart=function(b,d){a.secrets_gender=b,a.secrets_profession=c;var e=[],f=[];window.setTimeout(function(){for(var a in b)f[a]=c3.generate({bindto:"#chart_secret_gender_"+b[a].qid,color:{pattern:["#FF9800","#B6B6B6"]},size:{width:200,height:140},legend:{show:!0},data:{columns:[["YES",b[a].Answers.Yes],["NO",b[a].Answers.No]],type:"pie",order:"desc"},donut:{width:40}}),window.setTimeout(function(a){f[a]=c3.generate({bindto:"#chart_secret_gender_"+b[a].qid,color:{pattern:["#1ABC9C","#2980B9","#BDC3C7","#E67E22","#E74C3C","#9B59B6"]},size:{width:200,height:100},data:{x:"x",columns:[["x","YES","NO"],["Male",b[a].Gender.Male.Yes,b[a].Gender.Male.No]],labels:!0,type:"bar"},bar:{width:{ratio:.5}},axis:{x:{type:"category"},y:{show:!1}}})},5e3+1e3*a,a),window.setTimeout(function(a){f[a].load({columns:[["Female",b[a].Gender.Female.Yes,b[a].Gender.Female.No]]})},1e4+2e3*a,a);for(var a in d)e[a]=c3.generate({bindto:"#chart_secret_profession_"+d[a].qid,color:{pattern:["#AFB42B","#B6B6B6"]},size:{width:200,height:140},legend:{show:!0},data:{columns:[["YES",d[a].Answers.Yes],["NO",d[a].Answers.No]],type:"pie",order:"desc"},donut:{width:40}}),window.setTimeout(function(a){e[a]=c3.generate({bindto:"#chart_secret_profession_"+d[a].qid,color:{pattern:["#00BCD4","#FBC02D"]},size:{width:200,height:100},data:{x:"x",columns:[["x","YES","NO"],[d[a].Professions.picktwo[0],d[a].Professions[d[a].Professions.picktwo[0]].Yes,d[a].Professions[d[a].Professions.picktwo[0]].No]],labels:!0,type:"bar"},bar:{width:{ratio:.5}},axis:{x:{type:"category"},y:{show:!1}}})},5e3+1e3*a,a),window.setTimeout(function(a){e[a].load({columns:[[d[a].Professions.picktwo[1],d[a].Professions[d[a].Professions.picktwo[1]].Yes,d[a].Professions[d[a].Professions.picktwo[1]].No]]})},1e4+2e3*a,a)})},a.renderSecretChart(b,c),a.profession_secrets_list=c,a.gender_secrets_list=b,a.total_profession_secrets=d,a.total_gender_secrets=e}]),angular.module("firebase.config",[]).constant("FBURL","https://taiwanuxd-dev.firebaseio.com"),angular.module("firebase.utils",["firebase","firebase.config"]).factory("fbutil",["$window","FBURL","$firebase",function(a,b,c){"use strict";function d(a){for(var b=0;b<a.length;b++)if(angular.isArray(a[b]))a[b]=d(a[b]);else if("string"!=typeof a[b])throw new Error("Argument "+b+" to firebaseRef is not a string: "+a[b]);return a.join("/")}function e(){var c=new a.Firebase(b),e=Array.prototype.slice.call(arguments);return e.length&&(c=c.child(d(e))),c}function f(a,b){var d=e(a);return b=angular.extend({},b),angular.forEach(["limit","startAt","endAt"],function(a){if(b.hasOwnProperty(a)){var c=b[a];d=d[a].apply(d,angular.isArray(c)?c:[c]),delete b[a]}}),c(d,b)}return{syncObject:function(){return f.apply(null,arguments).$asObject()},syncArray:function(){return f.apply(null,arguments).$asArray()},ref:e}}]),angular.module("FerryBuildingApp").config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/login",{templateUrl:"views/login.html",controller:"loginCtrl"}).when("/secrets",{templateUrl:"views/secrets.html",controller:"SecretsCtrl",resolve:{curAuth:["Auth",function(a){return a.$requireAuth()}]}}).when("/questions",{templateUrl:"views/questions.html",controller:"QuestionsCtrl",resolve:{curAuth:["Auth",function(a){return a.$requireAuth()}]}}).when("/projects",{templateUrl:"views/projects.html",controller:"ProjectsCtrl",resolve:{curAuth:["Auth",function(a){return a.$requireAuth()}]}}).when("/members",{templateUrl:"views/members.html",controller:"MembersCtrl",resolve:{curAuth:["Auth",function(a){return a.$requireAuth()}]}}).otherwise({redirectTo:"/"})}]),angular.module("FerryBuildingApp").filter("reverse",function(){return function(a){return angular.isArray(a)?a.slice().reverse():[]}});